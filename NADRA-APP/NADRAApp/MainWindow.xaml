<Window x:Class="NADRAApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="NADRA Database Management System" Height="900" Width="1400"
        WindowStartupLocation="CenterScreen" WindowState="Maximized"
        Background="{StaticResource LightGray}">


    <Grid>
        <!-- Login Panel (Initially Visible) -->
        <Grid x:Name="LoginPanel" Background="#F5F5F5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Panel - NADRA Branding -->
            <Border Grid.Column="0" Background="#1B4332">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Margin="50">
                    <TextBlock Text="ðŸ›ï¸" FontSize="120" HorizontalAlignment="Center" 
                              Margin="0,0,0,30" Foreground="White"/>
                    
                    <TextBlock Text="NADRA" FontSize="48" FontWeight="Bold" 
                              Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                    
                    <TextBlock Text="National Database &amp; Registration Authority" 
                              FontSize="18" Foreground="#B8E6B8" 
                              HorizontalAlignment="Center" TextAlignment="Center"
                              LineHeight="24" Margin="0,0,0,40"/>
                    

                </StackPanel>
            </Border>
            
            <!-- Right Panel - Login Form -->
            <Border Grid.Column="1" Background="White">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" 
                           MaxWidth="400" Margin="50">
                    
                    <TextBlock Text="System Login" FontSize="32" FontWeight="Bold" 
                              HorizontalAlignment="Center" Margin="0,0,0,50" 
                              Foreground="#1B4332"/>
                    
                    <!-- Username Field -->
                    <TextBlock Text="ðŸ‘¤ Username" FontSize="16" FontWeight="SemiBold" 
                              Foreground="#2E3440" Margin="0,0,0,10"/>
                    <TextBox x:Name="UsernameTextBox" 
                            Text="admin"
                            Padding="15" FontSize="16" Height="55"
                            BorderThickness="2" BorderBrush="#CCCCCC"
                            Background="White" Margin="0,0,0,25"
                            Style="{StaticResource ModernTextBox}"/>
                    
                    <!-- Password Field -->
                    <TextBlock Text="ðŸ”’ Password" FontSize="16" FontWeight="SemiBold" 
                              Foreground="#2E3440" Margin="0,0,0,10"/>
                    <PasswordBox x:Name="PasswordBox" 
                                Padding="15" FontSize="16" Height="55"
                                BorderThickness="2" BorderBrush="#CCCCCC"
                                Background="White" Margin="0,0,0,35"/>
                    
                    <!-- Login Button -->
                    <Button x:Name="LoginButton" 
                           Content="ðŸ” LOGIN TO SYSTEM" 
                           FontSize="18" FontWeight="Bold" Height="65"
                           Background="#1B4332" Foreground="White"
                           BorderThickness="0" Cursor="Hand"
                           Click="LoginButton_Click" Margin="0,0,0,25">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" 
                                                   CornerRadius="8" Padding="{TemplateBinding Padding}">
                                                <Border.Effect>
                                                    <DropShadowEffect Color="Black" Opacity="0.3" ShadowDepth="4" BlurRadius="8"/>
                                                </Border.Effect>
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#2D6A4F"/>
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter Property="Background" Value="#0F2A1A"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                    </Button>
                    
                    <!-- Status Message -->
                    <TextBlock x:Name="LoginStatusMessage" 
                              Text="" 
                              FontSize="12" Foreground="#666"
                              HorizontalAlignment="Center" 
                              Margin="0,0,0,20" TextWrapping="Wrap"
                              TextAlignment="Center"/>
                    

                </StackPanel>
            </Border>
        </Grid>
        
        <!-- Main Application Panel (Initially Hidden) -->
        <Grid x:Name="MainPanel" Visibility="Collapsed">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource PrimaryGreen}" Padding="25">
            <Border.Effect>
                <DropShadowEffect Color="Black" Opacity="0.2" ShadowDepth="3" BlurRadius="10"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Border Background="White" CornerRadius="25" Width="50" Height="50" Margin="0,0,20,0">
                        <TextBlock Text="ðŸ›ï¸" FontSize="28" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="NADRA" Style="{StaticResource HeaderText}" FontSize="28"/>
                        <TextBlock Text="National Database &amp; Registration Authority" 
                                  Foreground="#E8F5E8" FontSize="14" Margin="0,-5,0,0"/>
                    </StackPanel>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- Real-time Clock -->
                    <Border Background="White" CornerRadius="12" Padding="10,6" Margin="0,0,10,0" Opacity="0.9">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ•" FontSize="14" Margin="0,0,6,0"/>
                            <TextBlock x:Name="ClockTextBlock" Text="12:00 PM" 
                                      Foreground="{StaticResource DarkGray}" FontWeight="SemiBold" FontSize="12"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Administrator Info -->
                    <Border Background="White" CornerRadius="15" Padding="12,8" Margin="0,0,10,0" Opacity="0.9">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ‘¤" FontSize="16" Margin="0,0,8,0"/>
                            <TextBlock Text="Administrator" Foreground="{StaticResource DarkGray}" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Logout Button -->
                    <Button x:Name="LogoutButton" Content="ðŸšª Logout" 
                           Background="#DC3545" Foreground="White" 
                           FontSize="14" FontWeight="SemiBold"
                           Padding="15,8" BorderThickness="0" 
                           Cursor="Hand" Click="LogoutButton_Click">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" 
                                                   CornerRadius="15" Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#C82333"/>
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter Property="Background" Value="#A71E2A"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Search and Controls -->
        <Border Grid.Row="1" Background="White" Padding="25" Margin="0,0,0,10">
            <Border.Effect>
                <DropShadowEffect Color="Black" Opacity="0.1" ShadowDepth="2" BlurRadius="8"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="{StaticResource LightGreen}" CornerRadius="25" Padding="15,0" Margin="0,0,15,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ”" FontSize="16" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <TextBox x:Name="SearchTextBox" 
                                    Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                    Width="350" Height="35" 
                                    FontSize="14" 
                                    Background="Transparent"
                                    BorderThickness="0"
                                    VerticalContentAlignment="Center"
                                    Padding="5"/>
                        </StackPanel>
                    </Border>
                    <Button Content="ðŸ” Search" 
                           Command="{Binding SearchCommand}"
                           Style="{StaticResource PrimaryButton}"/>

                </StackPanel>
                
                <WrapPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="âž• Add Citizen" 
                           Click="AddCitizen_Click"
                           Style="{StaticResource PrimaryButton}"/>
                    <Button Content="âœï¸ Edit" 
                           Click="EditCitizen_Click"
                           Style="{StaticResource SecondaryButton}"/>
                    <Button Content="ðŸ—‘ï¸ Delete" 
                           Command="{Binding DeleteCitizenCommand}"
                           Style="{StaticResource DangerButton}"/>
                    <Button Content="ðŸ“Š Reports" 
                           Click="Reports_Click"
                           Style="{StaticResource PrimaryButton}"
                           Background="#9C27B0"/>
                    <Button Content="ðŸ” Face Recognition" 
                           Click="FaceRecognition_Click"
                           Style="{StaticResource PrimaryButton}"
                           Background="#FF5722"/>
                </WrapPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="2" Margin="20,0,20,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="15"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Citizens List Card -->
            <Border Grid.Column="0" Style="{StaticResource Card}" Padding="0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <Border Grid.Row="0" Background="{StaticResource AccentGreen}" CornerRadius="8,8,0,0" Padding="20,15">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ‘¥" FontSize="20" Foreground="White" Margin="0,0,10,0"/>
                            <TextBlock Text="Citizens Database" Style="{StaticResource HeaderText}" FontSize="18"/>
                            <Border Background="White" CornerRadius="12" Padding="8,4" Margin="15,0,0,0">
                                <TextBlock Text="{Binding Citizens.Count, StringFormat={}{0} Records}" 
                                          Foreground="{StaticResource AccentGreen}" FontWeight="Bold" FontSize="12"/>
                            </Border>
                        </StackPanel>
                    </Border>
                    
                    <DataGrid Grid.Row="1" x:Name="CitizensDataGrid"
                             ItemsSource="{Binding Citizens}"
                             SelectedItem="{Binding SelectedCitizen}"
                             Style="{StaticResource ModernDataGrid}"
                             Margin="20,15,20,20">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ðŸ“‹ CNIC" Binding="{Binding CNIC}" Width="130"/>
                            <DataGridTextColumn Header="ðŸ‘¤ First Name" Binding="{Binding FirstName}" Width="110"/>
                            <DataGridTextColumn Header="ðŸ‘¤ Last Name" Binding="{Binding LastName}" Width="110"/>
                            <DataGridTextColumn Header="ðŸ‘¨ Father Name" Binding="{Binding FatherName}" Width="120"/>
                            <DataGridTextColumn Header="âš§ Gender" Binding="{Binding Gender}" Width="80"/>
                            <DataGridTextColumn Header="ðŸ™ï¸ City" Binding="{Binding City}" Width="90"/>
                            <DataGridTextColumn Header="ðŸ“ž Phone" Binding="{Binding PhoneNumber}" Width="110"/>
                            <DataGridTextColumn Header="ðŸ“… Registered" Binding="{Binding RegistrationDate, StringFormat=dd/MM/yyyy}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>

            <!-- Citizen Details Card -->
            <Border Grid.Column="2" Style="{StaticResource Card}" Padding="0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <Border Grid.Row="0" Background="{StaticResource SecondaryGreen}" CornerRadius="8,8,0,0" Padding="20,15">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ“„" FontSize="18" Foreground="White" Margin="0,0,10,0"/>
                            <TextBlock Text="Citizen Details" Style="{StaticResource HeaderText}" FontSize="16"/>
                        </StackPanel>
                    </Border>
                    
                    <ScrollViewer Grid.Row="1" Padding="20">
                        <StackPanel DataContext="{Binding SelectedCitizen}">
                            <!-- Photo Section -->
                            <Border Background="{StaticResource LightGray}" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                                <StackPanel HorizontalAlignment="Center">
                                    <Border Background="White" CornerRadius="8" Padding="5" Margin="0,0,0,10">
                                        <Image x:Name="CitizenPhoto" 
                                              Width="120" Height="150" 
                                              Stretch="UniformToFill"
                                              Source="{Binding PhotoPath, Converter={StaticResource ImagePathConverter}}"/>
                                    </Border>
                                    <TextBlock Text="ðŸ“· Citizen Photo" HorizontalAlignment="Center" 
                                              Foreground="{StaticResource DarkGray}" FontSize="12"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Personal Information -->
                            <Border Background="White" BorderBrush="{StaticResource BorderGray}" 
                                   BorderThickness="1" CornerRadius="6" Padding="15" Margin="0,0,0,10">
                                <StackPanel>
                                    <TextBlock Text="ðŸ“‹ Personal Information" FontWeight="Bold" 
                                              Foreground="{StaticResource AccentGreen}" Margin="0,0,0,10"/>
                                    
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="CNIC:" FontWeight="SemiBold" Margin="0,5,10,5"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding CNIC}" Margin="0,5"/>
                                        
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Name:" FontWeight="SemiBold" Margin="0,5,10,5"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Margin="0,5">
                                            <TextBlock.Text>
                                                <MultiBinding StringFormat="{}{0} {1}">
                                                    <Binding Path="FirstName"/>
                                                    <Binding Path="LastName"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                        
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Father:" FontWeight="SemiBold" Margin="0,5,10,5"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding FatherName}" Margin="0,5"/>
                                        
                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="DOB:" FontWeight="SemiBold" Margin="0,5,10,5"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding DateOfBirth, StringFormat=dd/MM/yyyy}" Margin="0,5"/>
                                        
                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Gender:" FontWeight="SemiBold" Margin="0,5,10,5"/>
                                        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding Gender}" Margin="0,5"/>
                                        
                                        <TextBlock Grid.Row="5" Grid.Column="0" Text="Blood:" FontWeight="SemiBold" Margin="0,5,10,5"/>
                                        <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding BloodGroup}" Margin="0,5"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- Contact Information -->
                            <Border Background="White" BorderBrush="{StaticResource BorderGray}" 
                                   BorderThickness="1" CornerRadius="6" Padding="15" Margin="0,0,0,10">
                                <StackPanel>
                                    <TextBlock Text="ðŸ“ž Contact Information" FontWeight="Bold" 
                                              Foreground="{StaticResource AccentGreen}" Margin="0,0,0,10"/>
                                    
                                    <TextBlock Text="{Binding Address}" TextWrapping="Wrap" Margin="0,5"/>
                                    <TextBlock Text="{Binding City, StringFormat='ðŸ™ï¸ {0}'}" Margin="0,5"/>
                                    <TextBlock Text="{Binding Province, StringFormat='ðŸ—ºï¸ {0}'}" Margin="0,5"/>
                                    <TextBlock Text="{Binding PhoneNumber, StringFormat='ðŸ“ž {0}'}" Margin="0,5"/>
                                    <TextBlock Text="{Binding Email, StringFormat='ðŸ“§ {0}'}" Margin="0,5"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Additional Information -->
                            <Border Background="White" BorderBrush="{StaticResource BorderGray}" 
                                   BorderThickness="1" CornerRadius="6" Padding="15">
                                <StackPanel>
                                    <TextBlock Text="â„¹ï¸ Additional Information" FontWeight="Bold" 
                                              Foreground="{StaticResource AccentGreen}" Margin="0,0,0,10"/>
                                    
                                    <TextBlock Text="{Binding MaritalStatus, StringFormat='ðŸ’ {0}'}" Margin="0,5"/>
                                    <TextBlock Text="{Binding Occupation, StringFormat='ðŸ’¼ {0}'}" Margin="0,5"/>
                                    <TextBlock Text="{Binding RegistrationDate, StringFormat='ðŸ“… Registered: {0:dd/MM/yyyy}'}" 
                                              Margin="0,5" Foreground="{StaticResource DarkGray}" FontSize="12"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="3" Background="{StaticResource PrimaryGreen}" Padding="20,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Border Background="White" CornerRadius="15" Padding="12,6" Margin="0,0,15,0" Opacity="0.9">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ‘¥" FontSize="14" Margin="0,0,8,0"/>
                            <TextBlock Text="{Binding Citizens.Count, StringFormat={}Total Citizens: {0}}" 
                                      Foreground="{StaticResource DarkGray}" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Background="White" CornerRadius="15" Padding="12,6" Opacity="0.9">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ•’" FontSize="14" Margin="0,0,8,0"/>
                            <TextBlock Text="{Binding Source={x:Static sys:DateTime.Now}, StringFormat={}Last Updated: {0:HH:mm:ss}}" 
                                      Foreground="{StaticResource DarkGray}" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,15,0">
                    <Border Background="White" CornerRadius="15" Padding="12,6" Opacity="0.9">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ”—" FontSize="14" Margin="0,0,8,0"/>
                            <TextBlock Text="MySQL Connected" Foreground="{StaticResource AccentGreen}" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <ProgressBar x:Name="LoadingProgressBar" 
                               Width="200" Height="20"
                               IsIndeterminate="{Binding IsLoading}"
                               Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"
                               Background="White" Foreground="{StaticResource AccentGreen}"
                               BorderThickness="0"/>
                    <TextBlock Text="NADRA Â© 2025" Foreground="White" FontSize="12" 
                              VerticalAlignment="Center" Margin="15,0,0,0" Opacity="0.8"/>
                </StackPanel>
            </Grid>
        </Border>
        </Grid>
    </Grid>
</Window>